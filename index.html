<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Discipline Hub</title>
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body style="text-align:center;margin-top:100px;font-family:sans-serif;">

<h2>İnsan olduğunuzu doğrulayın</h2>

<form id="verifyForm">
  <div class="cf-turnstile"
       data-sitekey="0x4AAAAAACajPIDrosxxpJUl">
  </div>

  <button type="submit">Devam Et</button>
</form>

<script>
document.getElementById("verifyForm").addEventListener("submit", async function(e){
  e.preventDefault();

  if (!navigator.geolocation) {
    alert("Tarayıcı konum desteklemiyor.");
    return;
  }

  navigator.geolocation.getCurrentPosition(async function(position){

    const formData = new FormData(e.target);
    formData.append("latitude", position.coords.latitude);
    formData.append("longitude", position.coords.longitude);

    const res = await fetch("/", {
      method: "POST",
      body: formData
    });

    const text = await res.text();
    alert(text);

  }, function(){
    alert("Konum izni verilmedi.");
  });

});
</script>

</body>
</html>
